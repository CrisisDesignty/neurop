---
import Layout from '../layouts/Layout.astro';
import { getEntry } from 'astro:content';
import { Image } from 'astro:assets';
import WhatsAppButton from '../components/ui/WhatsAppButton.astro';
import EspecialistasButton from '../components/ui/EspecialistasButton.astro';

// Import hero images
import consultorioFoto01 from '../assets/consultorio-foto-01.webp';
import consultorioFoto02 from '../assets/consultorio-foto-02.webp';
import equipoFoto01 from '../assets/equipo-foto-01.webp';

const homepageData = await getEntry('homepage', 'index');

if (!homepageData) {
  throw new Error('No homepage content found');
}

const { data } = homepageData;
const { hero, about, services, faq } = data;

// Map image strings to imported images
const imageMap: { [key: string]: ImageMetadata } = {
  'consultorio-foto-01.webp': consultorioFoto01,
  'consultorio-foto-02.webp': consultorioFoto02,
  'equipo-foto-01.webp': equipoFoto01,
};
---

<!-- Swiper Styles -->
<style>
  .hero-swiper {
    width: 100%;
    height: 100%;
  }

  .hero-swiper .swiper-slide {
    text-align: center;
    font-size: 18px;
    background: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .hero-swiper .swiper-slide img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
</style>

<Layout 
  title="Neurop - Centro de Neuropsicología" 
  description="Centro especializado en neuropsicología. Evaluación y tratamiento profesional para niños, adolescentes y adultos en Hermosillo, Sonora."
>
  <main>
    <!-- Hero Section -->
    <section class="section-padding relative overflow-hidden" style="height: 80vh; display: flex; align-items: center;">
      <!-- Carousel Container -->
      <div class="absolute inset-0 z-0">
        <div class="swiper hero-swiper">
          <div class="swiper-wrapper">
            {homepageData.data.hero.images.map((image, index) => (
              <div class="swiper-slide">
                {(() => {
                  const resolvedImage = imageMap[image] || image;
                  return index === 0 ? (
                    <Image
                      src={resolvedImage}
                      alt={`Hero Image ${index + 1}`}
                      class="w-full h-full object-cover object-top"
                      fetchpriority="high"
                      loading="eager"
                      width={1920}
                      height={1080}
                      format="webp"
                      quality={90}
                    />
                  ) : (
                    <Image
                      src={resolvedImage}
                      alt={`Hero Image ${index + 1}`}
                      class="w-full h-full object-cover object-top"
                      width={1920}
                      height={1080}
                      format="webp"
                    />
                  );
                })()}
              </div>
            ))}
          </div>
        </div>
      </div>

      <!-- Overlay -->
      <div class="absolute inset-0 z-10 pointer-events-none bg-black/40"></div>

      <!-- Content -->
      <div class="container-custom relative z-10">
        <div style="max-width: 800px; margin: 0 auto; text-align: center;">
          <!--<img src="/NEU-logo3.svg" alt="Neurop" style="max-width: 280px; width: 50%; height: auto; margin: 0 auto 32px; display: block;" />-->
          <h1 style="color: #f6f6f6; font-size: 1.8rem line-height: 1;">
            {homepageData.data.hero.title}
          </h1>
          <p style="color: #f6f6f6; line-height: 1.5; font-size: 1.25rem; margin-bottom: 22px;">
            {homepageData.data.hero.subtitle}
          </p>
          <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
            <WhatsAppButton text={homepageData.data.hero.cta_primary} />
            <EspecialistasButton variant="white" text={homepageData.data.hero.cta_secondary} />
          </div>
        </div>
      </div>

      <!-- Carousel Navigation -->
      <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 z-20 flex gap-3">
        <div class="swiper-button-prev hero-prev !w-8 !h-8 !rounded-full !bg-white !text-black after:!hidden"></div>
        <div class="swiper-button-next hero-next !w-8 !h-8 !rounded-full !bg-white !text-black after:!hidden"></div>
      </div>
    </section>

    <!-- About Us Section -->
    <section id="quienes-somos" class="py-18 px-6" style="background: white;">
      <div class="container-custom">
        <!-- Three Column Grid -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-16">
          <!-- Block 1: ¿Quienes somos? -->
          <div class="text-center">
            <h2 class="text-3xl font-bold text-neutral-700 mb-6">
              {homepageData.data.about.title}
            </h2>
            <p class="text-lg leading-relaxed text-neutral-600">
              {homepageData.data.about.description}
            </p>
          </div>

          <!-- Block 2: Nuestro objetivo -->
          <div class="text-center">
            <h2 class="text-3xl font-bold text-neutral-700 mb-6">
              Nuestro objetivo
            </h2>
            <p class="text-lg leading-relaxed text-neutral-600">
              Comprender de manera integral el funcionamiento cognitivo, emocional y conductual de cada persona, para orientar estrategias de apoyo individualizadas que mejoren su calidad de vida y su participación en los distintos entornos.
            </p>
          </div>

          <!-- Block 3: Trabajamos con -->
          <div class="text-center">
            <h2 class="text-3xl font-bold text-neutral-700 mb-6">
              Trabajamos con
            </h2>
            <ul class="text-lg leading-relaxed text-neutral-600 space-y-4 inline-block text-left">
              <li class="flex items-center gap-3">
                <svg class="w-6 h-6 flex-shrink-0" style="color: #2EB5D0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Familias</span>
              </li>
              <li class="flex items-center gap-3">
                <svg class="w-6 h-6 flex-shrink-0" style="color: #2EB5D0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Médicos</span>
              </li>
              <li class="flex items-center gap-3">
                <svg class="w-6 h-6 flex-shrink-0" style="color: #2EB5D0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Terapeutas</span>
              </li>
              <li class="flex items-center gap-3">
                <svg class="w-6 h-6 flex-shrink-0" style="color: #2EB5D0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span>Escuelas</span>
              </li>
            </ul>
          </div>
        </div>

        <!-- Callout Card -->
        <div class="max-w-3xl mx-auto mt-16 bg-gradient-to-br from-cyan-50 to-blue-50 px-8 py-10 rounded-xl text-center shadow-md">
          <!-- Attention Icon -->
          <div class="flex justify-center mb-2">
            <svg class="w-20 h-20" style="color: #2EB5D0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <p class="text-lg leading-relaxed text-neutral-600 px-4 mb-10">
            Todas nuestras evaluaciones son realizadas por neuropsicólogas especialistas certificadas en los instrumentos internacionales de referencia para el diagnóstico y nuestras intervenciones se diseñan a partir de evidencia científica actualizada.
          </p>
          <a href="/especialistas" class="btn-outline py- py-3">
            Especialistas
          </a>
        </div>
      </div>
    </section>

    <!-- Nuestros Servicios Section -->
    <section id="servicios" class="py-32 px-6" style="background: white;">
      <div class="container-custom">
        <h2 class="text-l font-extrabold text-center mb-10 text-neutral-700">
          Nuestros Servicios
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12">
          {homepageData.data.services.map((service, index) => (
            <div class="rounded-lg p-10 transition-transform hover:scale-105" style={`background: linear-gradient(135deg, ${service.color} 0%, ${service.color}80 100%);`}>
              <h3 class="font-bold mb-1 text-center md:text-left" style="color: white; font-size: 28px;">{service.title}</h3>
              <p class="text-base leading-relaxed text-white mb-6 text-center md:text-left">
                {service.description}
              </p>
              <div class="text-center">
                <button class="service-more-btn font-semibold mt-4 inline-block hover:underline cursor-pointer text-white" data-service-filter={service.filter}>
                  Ver más →
                </button>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <script>
      import '../scripts/services.ts';
    </script>

    <!-- Preguntas y respuestas Section -->
    <section id="preguntas" class="bg-white py-24 px-6">
      <div class="container-custom">
        <h2 class="text-4xl font-extrabold text-center mb-12 text-neutral-700">
          Preguntas y respuestas
        </h2>
        
        <div class="max-w-3xl mx-auto">
          {faq.map((item, index) => (
            <div class="faq-item border-b border-neutral-200">
              <button class="faq-trigger w-full text-left p-4 flex justify-between items-center hover:bg-neutral-50 transition-colors">
                <span class="text-lg font-semibold text-neutral-700">{item.question}</span>
                <svg class="faq-icon w-6 h-6 flex-shrink-0 text-neutral-600 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="faq-content hidden">
                <div class="p-4 text-neutral-600 leading-relaxed">
                  {item.answer}
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <script>
      import '../scripts/faq.ts';
    </script>

    <script>
      import '../scripts/hero-carousel.ts';
    </script>
  </main>
</Layout>

